function [ Y ] = ecg_var_filter( X, Fs, L )
%ECG_VAR_FILTER Filters ECG Signals
% X must be singular dimension!
Y = zeros(L, 1);
if(Fs==250)
    b = [0.0418768282347742,0,-0.125630484704323,0,0.125630484704323,0,-0.0418768282347742];
    a = [1,-3.99412602172993,6.79713743558926,-6.44840721730666,3.65712515526032,-1.17053739881085,0.159769122451512];
    Y = filtfilt(b,a,X);
elseif (Fs == 500) 
    b = [0.007167667426659,0,-0.021503002279976,0,0.021503002279976,0,-0.007167667426659];
    a = [1,-5.044567679445925,10.694677001386529,-12.217373564180143,7.941456333391799,-2.786010160036419,0.411839132950083];
    Y = filtfilt(b,a,X);
elseif (Fs == 1000)
    b = [0.001079489822260,0,-0.003238469466779,0,0.003238469466779,0,-0.001079489822260];
    a = [1,-5.539003107578458,12.814616286414871,-15.852598393614553,11.060956098498181,-4.127543191519715,0.643572706710650];
    Y = filtfilt(b,a,X);
elseif (Fs == 2000)
    b = [1.493138451363796e-04,0,-4.479415354091387e-04,0,4.479415354091387e-04,0,-1.493138451363796e-04];
    a = [1,-5.774488534845306,13.902482235402900,-17.862961622606818,12.918932118347655,-4.986464845874546,0.802500656483461];
    Y = filtfilt(b,a,X);
elseif (Fs == 4000)
    b = [1.967534621392585e-05,0,-5.902603864177754e-05,0,5.902603864177754e-05,0,-1.967534621392585e-05];
    a = [1,-5.888604447731812,14.450542855246466,-18.915859691827226,13.930370002411454,-5.472310085965352,0.895861367980286];
    Y = filtfilt(b,a,X);
end
Y=single(Y);

end

